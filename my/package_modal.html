<!doctype html>
<html lang="en">
 <head>
   <meta name="viewport" content="width=device-width, initial-scale=1" />
   <style scoped>*{margin:0;padding:0;box-sizing:border-box}:focus{outline:0}ul{list-style:none}body{font-family:Arial,Helvetica,sans-serif;background-color:#000;color:#fff;height:100vh;width:100%;display:flex;justify-content:center;align-items:center}.top-banner{background-color:#fbbc04;position:absolute;padding:1.5rem 4rem;top:0;left:50%;transform:translateX(-50%);text-align:center;border-radius:0 0 10px 10px}p.current-plan{font-size:.75rem;margin-bottom:.5rem}p.plan-type{font-size:1rem;font-weight:900}.container{text-align:center;width:1100px;height:60%}h1.title{letter-spacing:2px;margin-bottom:1.5rem}.toggle-switch{display:flex;height:30px;width:100%;justify-content:center;align-items:center;margin-bottom:1.5rem}.toggler{appearance:none;-webkit-appearance:none;-moz-appearance:none;width:50px;height:25px;background-color:#fbbc04;border-radius:25px;margin:0 1rem;position:relative}.toggler::before{content:"";width:16px;height:16px;background-color:#fff;position:absolute;border-radius:50%;top:50%;transform:translateY(-50%);right:4px}.toggler:checked:before{right:55%}.cards{display:flex;justify-content:space-between;align-items:center;width:100%;flex-wrap:wrap;height:100%}.card{height:30%;background-color:#22262c;border-radius:15px;padding:2rem;text-align:center}.card-title{font-size:1.5rem;font-weight:lighter;margin-bottom:1rem}.card-price{font-size:3rem;text-align:center}h2>span{font-size:1rem}#card-3 .card-price{font-size:2rem}#card-1 .card-price{margin-bottom:4rem}.card ul{text-align:left;font-size:.9rem;font-weight:lighter}.card ul li:before{content:"â€¢";margin-right:.5rem;color:#fbbc04;font-size:1.5rem}.card ul li{margin-bottom:.5rem}.card-btn{margin-top:1rem;width:100%;background-color:transparent;border:1px solid #fbbc04;color:#fff;font-size:1rem;padding:1rem;border-radius:5px}#card-1 .card-btn:hover,#card-3 .card-btn:hover,.active .card-btn{background-color:#fbbc04}#maus{background:0 0;color:#fff;border-color:#545c5c;margin-top:1rem;width:100%;padding:1rem 2rem;font-size:1rem;border-radius:5px}option{font-size:1.2rem;background-color:#333}.note{color:#fbbc04;font-size:.75rem;text-align:left;display:block;margin-top:5px}#card-2 ul{margin-top:3rem}#card-3 ul{margin-top:7.5rem}@media (max-width:1112px){.cards{justify-content:center}.card{width:40%;margin:2rem}}@media (max-width:848px){.card{width:50%}}@media (max-width:674px){.top-banner{width:70%}.card{width:70%}}@media (max-width:500px){.top-banner{width:90%}.card{width:90%}}</style>
                                                    
 
 <body>
     
    <div class="top-banner">
        <p class="current-plan">Available Plans</p>
        <p class="plan-type">Please select plan that best meets your company</p>
    </div>
                                                        
    <div class="container" style="margin-top: -8%">
        <h1 class="title">Choose a plan</h1>
            <div class="toggle-switch">
                <span>Yearly </span>
                <input type="checkbox" class="toggler">
                <span> Monthly</span>
            </div>
                                                        
        <div class="cards" id="card-container">
                                            
       </div>
    </div>
<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>

    var companyid = localStorage.getItem("companyid");
    
    var userid = localStorage.getItem("userid");
    
    var packages = localStorage.getItem("packages");
    
    var packagesObject = JSON.parse(packages);
    
    var packagesHtml = '';
    
    var packagesObjectKeys = Object.keys(packagesObject);
    
    
    for(var i = 0; i < packagesObjectKeys.length; i++){
        
        var singlePackage = packagesObject[packagesObjectKeys[i]];
        
        const descriptionArray = singlePackage.description.split(',');
        
        var descriptionHtml = '';
        
        for(var k = 0; k < descriptionArray.length; k++){
            
           descriptionHtml+= '<li> '+ descriptionArray[k]+'</li>';
            
        }
        
        var form = ''; 
        
        if(singlePackage.type == "Monthly" || singlePackage.type == "Yearly"){
            
            form = '<form target="_top" action="'+window.location.origin+'/custom-php/create_checkout_session.php" method="POST">'+
                                            
                                            '<input type="hidden" name="priceId" value="'+singlePackage.priceid+'" />'+
                                            '<input type="hidden" name="packageId" value="'+singlePackage.id+'" />'+
                                            '<input type="hidden" name="userId" value="'+userid+'" />'+
                                            '<input type="hidden" name="companyId" value="'+companyid+'" />'+
                                            '<button class="card-btn" type="submit" target="_top">Checkout</button></form>';
            
        }else{
            
            var action = window.location.origin+'/my/index.php?activatetrial=1';
            
            form = '<form target="_top"  action="'+action+'" method="POST">'+
                                            
                                            '<input type="hidden" name="priceId" value="'+singlePackage.priceid+'" />'+
                                            '<input type="hidden" name="packageId" value="'+singlePackage.id+'" />'+
                                            '<input type="hidden" name="userId" value="'+userid+'" />'+
                                            '<input type="hidden" name="mode" value="'+singlePackage.type+'" />'+
                                            '<input type="hidden" name="companyId" value="'+companyid+'" />'+
                                            '<button class="card-btn" type="button" onclick="checkoutTrial(this)" target="_top">Checkout</button></form>';
            
        }
        
        
        packagesHtml += '<div style="height:700px;padding-bottom: 10%;" class="'+singlePackage.type.toLowerCase()+' card" id="card-'+(i+1)+'">'+
                            '<h1 class="card-title">'+singlePackage.name+'</h1>'+
                                   '<h2 style="font-size: 3rem;text-align: center;" id="starter-price"> $'+singlePackage.amount+' <span> / '+singlePackage.type+'</span> </h2>'+
                                    '<h3 style="margin-top: 1.5rem;" class="card-title">Max users: '+singlePackage.num_users+'</h3>'+
                                        '<ul style="margin-top: 1.5rem;">'+
                                        descriptionHtml+
                                            '</ul>'+form+
                                            // '<button type="button" onclick="location.href = \''+location.origin+'/my/payment.php?packageid='+singlePackage.id+'&companyid='+companyid+'&userid='+userid+'\';" class="card-btn"> Choose Plan</button>'+
                        '</div><br>';
        
    }
    
        var container = document.getElementById('card-container');                                                        
        container.innerHTML = packagesHtml;

        container.insertAdjacentHTML('afterend', '<div class="row" style="height:300px;"></div>');
        
        const toggler = document.querySelector(".toggler");
        const starterPrice = document.getElementById("starter-price");
        const proPrice = document.getElementById("pro-price");
        
        hideElementsWithClassName('yearly');
        
        toggler.addEventListener("change", ()=>{
            if(!toggler.checked){
                
                hideElementsWithClassName('yearly');
                showElementsWithClassName('monthly');
            }else{
                hideElementsWithClassName('monthly');
                showElementsWithClassName('yearly');
            }
        });
        
        // Hide neccessary elements 
        
        removeElementFromDOM('.iomad_company_admin');
        
        removeElementFromDOM('.block_mycourses');
        
        removeElementFromDOM('.block_recentlyaccessedcourses');
        
        removeElementFromDOM('.block_recentlyaccessedcourses');
        
        function hideElementsWithClassName(className){
            var divsToHide = document.getElementsByClassName(className); //divsToHide is an array
            for(var i = 0; i < divsToHide.length; i++){
                divsToHide[i].style.visibility = "hidden"; // or
                divsToHide[i].style.display = "none"; // depending on what you're doing
            }
        }
        
        function showElementsWithClassName(className){
            var divsToHide = document.getElementsByClassName(className); //divsToHide is an array
            for(var i = 0; i < divsToHide.length; i++){
                divsToHide[i].style.visibility = "visible"; // or
                divsToHide[i].style.display = "block"; // depending on what you're doing
            }
        }
        
        function removeElementFromDOM(query){
            
            let element = document.querySelector(query);
            
            if(element){
                element.remove();
            } 
        }
        
        function waitForElm(selector) {
            return new Promise(resolve => {
                if (document.querySelector(selector)) {
                    return resolve(document.querySelector(selector));
                }
        
                const observer = new MutationObserver(mutations => {
                    if (document.querySelector(selector)) {
                        resolve(document.querySelector(selector));
                        observer.disconnect();
                    }
                });
        
                observer.observe(document.body, {
                    childList: true,
                    subtree: true
                });
            });
        }
        
        function closeIframe() {
            var iframe = document.getElementById('packages-iframe');
            iframe.parentNode.removeChild(iframe);
        }

        function checkoutTrial(e){
            console.log(e);
            var form = e.parentElement;
            // console.log(form);
            Swal.fire({
              title: 'Are you sure?',
              text: "You can only activate this FREE plan once, which will last for a period of 7 days.",
              icon: 'warning',
              showCancelButton: true,
              confirmButtonColor: '#3085d6',
              cancelButtonColor: '#d33',
              confirmButtonText: 'Yes!'
            }).then((result) => {
              if (result.isConfirmed) {
                 
                // Swal.fire(
                //   'Deleted!',
                //   'Your file has been deleted.',
                //   'success'
                // )
                
                form.submit();
              }
            });
            
        }


</script>

     
 </body>
</html>


